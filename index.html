<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PDF Checklist Viewer</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <div class="nav">
    <h3>Navigation</h3>
    <ul id="folderList"></ul>
  </div>

  <div class="viewer">
    <iframe id="pdfViewer" src="" type="application/pdf"></iframe>
    <div>
      <button onclick="prevFile()">← Prev File</button>
      <button onclick="nextFile()">Next File →</button>
    </div>
  </div>

  <div class="checklist">
    <h3>Checklist</h3>

    <!-- User ID input -->
    <div style="margin-bottom: 10px;">
      <label for="userIdInput"><strong>User ID:</strong></label>
      <input type="text" id="userIdInput" placeholder="Enter your unique ID" style="width: 100%; padding: 6px;" />
    </div>

    <!-- Checklist container and buttons -->
    <div id="checklistContainer"></div>

    <!-- Button Group Fixed at Bottom -->
    <div class="checklist-actions">
      <button onclick="downloadChecklist()">Download</button>

      <label for="importFile" class="upload-label">Upload</label>
      <input type="file" id="importFile" accept=".txt" onchange="importChecklist()" style="display: none;" />

      <button onclick="publishChecklist()">Publish</button>
    </div>
  </div>

  <!-- JavaScript Dependencies -->
  <script src="data.js"></script>
  <script src="navigation.js"></script>
  <script src="checklist.js"></script>
  <script src="viewer.js"></script>

  <!-- Module-based script for export logic -->
  <script type="module">
    import { publishChecklist } from './js/publish.js';
    import { downloadChecklist } from './js/download.js';
    import { importChecklist } from './js/import.js';

    // Attach to window to support inline onclick handlers
    window.publishChecklist = publishChecklist;
    window.downloadChecklist = downloadChecklist;
    window.importChecklist = importChecklist;
  </script>

  <!-- Main Startup Script -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      buildNavTree();
      if (flatFileList.length > 0) {
        setFile(flatFileList[0]);
      } else {
        console.warn("No files available in flatFileList.");
      }

      window.addEventListener("beforeunload", saveChecklistItem);
    });
  </script>

</body>
</html>
